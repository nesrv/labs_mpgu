# STEP-5: GraphQL Subscriptions (WebSocket)

## üéØ –¶–µ–ª—å

–î–æ–±–∞–≤–∏—Ç—å real-time —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ GraphQL Subscriptions –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[STEP_5_GUIDE.md](./STEP_5_GUIDE.md)** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –º–µ—Ç–æ–¥–∏—á–∫–∞ —Å –ø–æ—à–∞–≥–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
- **[WEBSOCKET_ANALYSIS.md](./WEBSOCKET_ANALYSIS.md)** - –ê–Ω–∞–ª–∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å —Ä–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è STEP-4
cd STEP-4
uvicorn main:app --reload
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: http://localhost:8000/graphql
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã STEP-5

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –∏–∑ STEP-4 –≤ STEP-5 (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã).

### 3. –°–æ–∑–¥–∞–π—Ç–µ Pub/Sub –º–µ–Ω–µ–¥–∂–µ—Ä

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `pubsub.py` (—Å–º. [STEP_5_GUIDE.md](./STEP_5_GUIDE.md#—à–∞–≥-1-—Å–æ–∑–¥–∞–Ω–∏–µ-pubsub-–º–µ–Ω–µ–¥–∂–µ—Ä–∞))

### 4. –î–æ–±–∞–≤—å—Ç–µ Subscription –∫–ª–∞—Å—Å

–î–æ–±–∞–≤—å—Ç–µ –≤ `schema.py` –∫–ª–∞—Å—Å `Subscription` (—Å–º. [STEP_5_GUIDE.md](./STEP_5_GUIDE.md#—à–∞–≥-2-–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ-subscription-–∫–ª–∞—Å—Å–∞))

### 5. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ö–µ–º—É

```python
schema = strawberry.Schema(
    query=Query,
    mutation=Mutation,
    subscription=Subscription  # –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ
)
```

### 6. –ü—É–±–ª–∏–∫—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –≤ –º—É—Ç–∞—Ü–∏—è—Ö

–î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏—é —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö (—Å–º. [STEP_5_GUIDE.md](./STEP_5_GUIDE.md#—à–∞–≥-4-–ø—É–±–ª–∏–∫–∞—Ü–∏—è-—Å–æ–±—ã—Ç–∏–π-–≤-–º—É—Ç–∞—Ü–∏—è—Ö))

### 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
uvicorn main:app --reload
# –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:8000/graphql
```

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
STEP-5/
‚îú‚îÄ‚îÄ pubsub.py              # Pub/Sub –º–µ–Ω–µ–¥–∂–µ—Ä (—Å–æ–∑–¥–∞—Ç—å)
‚îú‚îÄ‚îÄ schema.py              # GraphQL —Å—Ö–µ–º–∞ (–æ–±–Ω–æ–≤–∏—Ç—å)
‚îú‚îÄ‚îÄ message_resolvers.py   # –†–µ–∑–æ–ª–≤–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π (–æ–±–Ω–æ–≤–∏—Ç—å)
‚îú‚îÄ‚îÄ user_resolvers.py      # –†–µ–∑–æ–ª–≤–µ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ main.py                # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îî‚îÄ‚îÄ models_graphql.py      # GraphQL —Ç–∏–ø—ã
```

## üîç –ß—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è

- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

## üìñ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

```graphql
subscription {
  messageAdded {
    id
    title
    content
    authorId
    createdAt
  }
}
```

### –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

```graphql
subscription {
  commentAdded(messageId: 1) {
    id
    content
    authorId
    createdAt
  }
}
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [ ] –°–æ–∑–¥–∞–Ω `pubsub.py`
- [ ] –î–æ–±–∞–≤–ª–µ–Ω –∫–ª–∞—Å—Å `Subscription` –≤ `schema.py`
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ (–¥–æ–±–∞–≤–ª–µ–Ω `subscription=Subscription`)
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –≤ –º—É—Ç–∞—Ü–∏—è—Ö
- [ ] –ü–æ–¥–ø–∏—Å–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

–°–º. —Ä–∞–∑–¥–µ–ª [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](./STEP_5_GUIDE.md#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º) –≤ –º–µ—Ç–æ–¥–∏—á–∫–µ.

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Strawberry Subscriptions](https://strawberry.rocks/docs/guides/subscriptions)
- [GraphQL Subscriptions Spec](https://graphql.org/learn/queries/#subscriptions)

---

**–î–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å–º. [STEP_5_GUIDE.md](./STEP_5_GUIDE.md)**

