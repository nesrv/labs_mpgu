–û—Ç–ª–∏—á–Ω–æ, –¥–∞–≤–∞–π –æ–±–Ω–æ–≤–∏–º –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É—é **–ø–æ–¥ Apache Kafka 4.1.1 (KRaft, –±–µ–∑ ZooKeeper)** üëç
–ù–∏–∂–µ ‚Äî **–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–¥–µ–ª–∞–Ω–Ω–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞**, –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –¥–ª—è Kafka **4.x**.

---

# üß™ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ1

## ¬´–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å Apache Kafka 4.1.1 (KRaft). Producer –∏ Consumer –Ω–∞ Python¬ª

---

## üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–ò–∑—É—á–∏—Ç—å –æ—Å–Ω–æ–≤—ã —Ä–∞–±–æ—Ç—ã **Apache Kafka 4.1.1** –≤ —Ä–µ–∂–∏–º–µ **KRaft (–±–µ–∑ ZooKeeper)**, –æ—Å–≤–æ–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ **producer** –∏ **consumer** –Ω–∞ —è–∑—ã–∫–µ **Python**, –∞ —Ç–∞–∫–∂–µ –Ω–∞—É—á–∏—Ç—å—Å—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏ –ø–æ–ª—É—á–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ Kafka.

---

## üìö –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è (–∫—Ä–∞—Ç–∫–æ)

–ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ **Kafka 4.x**, –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∂–∏–º **KRaft (Kafka Raft Metadata Mode)**:

- ‚ùå ZooKeeper **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Kafka
- –£–ø—Ä–æ—â–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è:

- **Topic** ‚Äî –∫–∞–Ω–∞–ª —Å–æ–æ–±—â–µ–Ω–∏–π
- **Producer** ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π
- **Consumer** ‚Äî –ø–æ–ª—É—á–∞—Ç–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π
- **Offset** ‚Äî –ø–æ–∑–∏—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
- **Broker** ‚Äî —Å–µ—Ä–≤–µ—Ä Kafka

---

## üß∞ –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ –ü–û

- –û–°: Windows / Linux / macOS
- Python **3.13+**
- Docker + Docker Compose
- Apache Kafka **4.1.1**
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `kafka-python`

---

## üîß –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ä–µ–¥—ã

## 1. –ó–∞–ø—É—Å–∫ Kafka 4.1.1 (KRaft) —á–µ—Ä–µ–∑ Docker

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª **`docker-compose.yml`**:

```yaml
services:
  kafka:
    image: apache/kafka:4.1.1
    container_name: kafka
    ports:
      - "19092:19092" # –ü–æ—Ä—Ç –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (producer/consumer —Å —Ö–æ—Å—Ç–∞)
      - "9093:9093" # –ü–æ—Ä—Ç –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ (KRaft)
    environment:
      KAFKA_NODE_ID: 1
      KAFKA_PROCESS_ROLES: broker,controller
      KAFKA_CONTROLLER_QUORUM_VOTERS: 1@localhost:9093

      KAFKA_LISTENERS: PLAINTEXT://0.0.0.0:9092,EXTERNAL://0.0.0.0:19092,CONTROLLER://0.0.0.0:9093
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092,EXTERNAL://localhost:19092
      KAFKA_CONTROLLER_LISTENER_NAMES: CONTROLLER
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT,EXTERNAL:PLAINTEXT
      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT

      KAFKA_LOG_DIRS: /var/lib/kafka/data
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
      KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR: 1
      KAFKA_TRANSACTION_STATE_LOG_MIN_ISR: 1
    volumes:
      - kafka-data:/var/lib/kafka/data
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "/opt/kafka/bin/kafka-broker-api-versions.sh --bootstrap-server localhost:9092 || exit 1",
        ]
      interval: 10s
      timeout: 5s
      retries: 10
      start_period: 60s

  kafka-ui:
    image: provectuslabs/kafka-ui:latest
    container_name: kafka-ui
    ports:
      - "8080:8080" # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Kafka
    environment:
      KAFKA_CLUSTERS_0_NAME: local
      KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS: kafka:9092
    depends_on:
      kafka:
        condition: service_healthy

volumes:
  kafka-data:
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö Docker Compose –∞—Ç—Ä–∏–±—É—Ç `version` —É—Å—Ç–∞—Ä–µ–ª –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ `version`, –µ–≥–æ –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å.

### –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ docker-compose.yml

#### –°–µ—Ä–≤–∏—Å `kafka`:

**–ü–æ—Ä—Ç—ã:**

- `19092:19092` ‚Äî –ø–æ—Ä—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (producer/consumer —Å —Ö–æ—Å—Ç–∞)
- `9093:9093` ‚Äî –ø–æ—Ä—Ç –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ KRaft (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

- `KAFKA_NODE_ID: 1` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —É–∑–ª–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
- `KAFKA_PROCESS_ROLES: broker,controller` ‚Äî —É–∑–µ–ª —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ broker –∏ controller –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (standalone —Ä–µ–∂–∏–º)
- `KAFKA_CONTROLLER_QUORUM_VOTERS: 1@localhost:9093` ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É, –≥–¥–µ –∏—Å–∫–∞—Ç—å –∫–≤–æ—Ä—É–º (–æ–¥–∏–Ω —É–∑–µ–ª –Ω–∞ –ø–æ—Ä—Ç—É 9093)
- `KAFKA_LISTENERS` ‚Äî –ø–æ—Ä—Ç—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö Kafka —Å–ª—É—à–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (PLAINTEXT –¥–ª—è Docker —Å–µ—Ç–∏, EXTERNAL –¥–ª—è —Ö–æ—Å—Ç–∞)
- `KAFKA_ADVERTISED_LISTENERS` ‚Äî –∞–¥—Ä–µ—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ–±—â–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º (kafka:9092 –¥–ª—è Docker, localhost:19092 –¥–ª—è —Ö–æ—Å—Ç–∞)
- `KAFKA_INTER_BROKER_LISTENER_NAME` ‚Äî –∏–º—è listener –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É –±—Ä–æ–∫–µ—Ä–∞–º–∏
- `KAFKA_LOG_DIRS` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö Kafka
- `KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1` ‚Äî —Ñ–∞–∫—Ç–æ—Ä —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –¥–ª—è —Ç–æ–ø–∏–∫–∞ —Å–º–µ—â–µ–Ω–∏–π (1 –¥–ª—è standalone)
- `KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR: 1` ‚Äî —Ñ–∞–∫—Ç–æ—Ä —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- `KAFKA_TRANSACTION_STATE_LOG_MIN_ISR: 1` ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–ø–ª–∏–∫ –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

**Volumes:**

- `kafka-data:/var/lib/kafka/data` ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö Kafka (–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏)

**Healthcheck:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Kafka —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `/opt/kafka/bin/kafka-broker-api-versions.sh`
- `interval: 10s` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- `timeout: 5s` ‚Äî —Ç–∞–π–º–∞—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ 5 —Å–µ–∫—É–Ω–¥
- `retries: 10` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ
- `start_period: 60s` ‚Äî –ø–µ—Ä–∏–æ–¥ –æ–∂–∏–¥–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –ø—Ä–æ–≤–µ—Ä–æ–∫ (–¥–∞—ë—Ç Kafka –≤—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫)

#### –°–µ—Ä–≤–∏—Å `kafka-ui`:

**–ü–æ—Ä—Ç—ã:**

- `8080:8080` ‚Äî –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Kafka

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

- `KAFKA_CLUSTERS_0_NAME: local` ‚Äî –∏–º—è –∫–ª–∞—Å—Ç–µ—Ä–∞
- `KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS: kafka:9092` ‚Äî –∞–¥—Ä–µ—Å Kafka –±—Ä–æ–∫–µ—Ä–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

- `depends_on: kafka` ‚Äî kafka-ui –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ Kafka —Å—Ç–∞–Ω–µ—Ç –∑–¥–æ—Ä–æ–≤–æ–π

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

1.  **Healthcheck –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π –ø—É—Ç—å** ‚Äî –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π –ø—É—Ç—å `/opt/kafka/bin/kafka-broker-api-versions.sh`, —Ç–∞–∫ –∫–∞–∫ –∫–æ–º–∞–Ω–¥—ã Kafka –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/opt/kafka/bin/` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

2.  **–ü–∞—Ä–∞–º–µ—Ç—Ä `start_period`** ‚Äî –¥–∞—ë—Ç Kafka 60 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—É—Å–∫ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è. –≠—Ç–æ –≤–∞–∂–Ω–æ, —Ç–∞–∫ –∫–∞–∫ Kafka —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ KRaft –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞.

3.  **–ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–º–∞–Ω–¥–æ–π `docker logs kafka` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º.

### –ó–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

```bash
docker-compose up -d
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Kafka:

```bash
docker logs kafka
```

–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```
Kafka Server started
```

–û—Ç–∫—Ä—ã—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Kafka UI:

```
http://localhost:8080
```

–í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –º–æ–∂–Ω–æ:

- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ç–æ–ø–∏–∫–∏
- –ß–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
- –°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–æ–ø–∏–∫–∏
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å consumer groups
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```bash
pip install kafka-python
```

> ‚ö†Ô∏è `kafka-python` —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å Kafka 4.x, —Ç–∞–∫ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É Kafka, –∞ –Ω–µ —á–µ—Ä–µ–∑ ZooKeeper.

---

## üß™ –•–æ–¥ —Ä–∞–±–æ—Ç—ã

## –®–∞–≥ 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞

> **–í–∞–∂–Ω–æ:** –í Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∫–æ–º–∞–Ω–¥—ã Kafka –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `/opt/kafka/bin/`, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å.

```bash
docker exec -it kafka /opt/kafka/bin/kafka-topics.sh  --create  --topic hello-kafka --bootstrap-server localhost:9092 --partitions 1 --replication-factor 1
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
docker exec -it kafka /opt/kafka/bin/kafka-topics.sh --list --bootstrap-server localhost:9092
```

–î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —Ç–æ–ø–∏–∫ `hello-kafka`.

---

## –®–∞–≥ 2. Producer (–æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π)

–§–∞–π–ª **`producer.py`**:

```python
from kafka import KafkaProducer
from kafka.errors import KafkaError
import time

try:
    producer = KafkaProducer(
        bootstrap_servers='localhost:19092',
        value_serializer=lambda v: v.encode('utf-8')
    )

    print("Producer –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ Kafka")
    print("–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...")

    for i in range(1, 6):
        message = f"Hello Kafka {i}"
        future = producer.send('hello-kafka', message)

        # –ñ–¥—ë–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏
        try:
            record_metadata = future.get(timeout=10)
            print(f"‚úì –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {message} (partition: {record_metadata.partition}, offset: {record_metadata.offset})")
        except KafkaError as e:
            print(f"‚úó –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: {e}")

        time.sleep(1)

    producer.flush()
    producer.close()
    print("\n–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")

except Exception as e:
    print(f"–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Kafka: {e}")
    print("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Kafka –∑–∞–ø—É—â–µ–Ω: docker-compose ps")
```

---

## –®–∞–≥ 3. Consumer (—á—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π)

–§–∞–π–ª **`consumer.py`**:

```python
from kafka import KafkaConsumer
from kafka.errors import KafkaError
import sys

try:
    consumer = KafkaConsumer(
        'hello-kafka',
        bootstrap_servers='localhost:19092',
        group_id='hello-group',
        auto_offset_reset='earliest',  # –ß–∏—Ç–∞—Ç—å —Å –Ω–∞—á–∞–ª–∞, –µ—Å–ª–∏ offset –Ω–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω
        value_deserializer=lambda v: v.decode('utf-8')
        # –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º consumer_timeout_ms - consumer –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
    )

    print("Consumer –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ Kafka")
    print("–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π...")
    print("(–ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)")
    print("\nüí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ó–∞–ø—É—Å—Ç–∏—Ç–µ producer.py –≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è\n")

    message_count = 0
    for msg in consumer:
        message_count += 1
        print(f"‚úì –ü–æ–ª—É—á–µ–Ω–æ [{message_count}]: {msg.value}")
        print(f"  Partition: {msg.partition}, Offset: {msg.offset}, Timestamp: {msg.timestamp}")

except KeyboardInterrupt:
    print("\n\nConsumer –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    consumer.close()
except KafkaError as e:
    print(f"–û—à–∏–±–∫–∞ Kafka: {e}")
    sys.exit(1)
except Exception as e:
    print(f"–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Kafka: {e}")
    print("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Kafka –∑–∞–ø—É—â–µ–Ω: docker-compose ps")
    sys.exit(1)
finally:
    if 'consumer' in locals():
        consumer.close()
```

---

## –®–∞–≥ 4. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º

> **‚ö†Ô∏è –í–∞–∂–Ω–æ:** –ü–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ!

### –í–∞—Ä–∏–∞–Ω—Ç 1: Consumer –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–¢–µ—Ä–º–∏–Ω–∞–ª 1 ‚Äî consumer (–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø–µ—Ä–≤—ã–º):**

```bash
python consumer.py
```

Consumer –Ω–∞—á–Ω—ë—Ç –∂–¥–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è. –í—ã —É–≤–∏–¥–∏—Ç–µ:

```
Consumer –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ Kafka
–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π...
(–ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)

üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ó–∞–ø—É—Å—Ç–∏—Ç–µ producer.py –≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
```

> **–í–∞–∂–Ω–æ:** Consumer –±—É–¥–µ—Ç –∂–¥–∞—Ç—å **–±–µ—Å–∫–æ–Ω–µ—á–Ω–æ**, –ø–æ–∫–∞ –Ω–µ –ø–æ—è–≤—è—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è. –ù–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —ç—Ç–æ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª!

**–¢–µ—Ä–º–∏–Ω–∞–ª 2 ‚Äî producer (–∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤–æ –≤—Ç–æ—Ä–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ):**

```bash
python producer.py
```

Producer –æ—Ç–ø—Ä–∞–≤–∏—Ç 5 —Å–æ–æ–±—â–µ–Ω–∏–π, –∏ consumer **—Å—Ä–∞–∑—É –∏—Ö –ø–æ–ª—É—á–∏—Ç** –≤ –ø–µ—Ä–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```
‚úì –ü–æ–ª—É—á–µ–Ω–æ [1]: Hello Kafka 1
  Partition: 0, Offset: 0, Timestamp: 1737049200000
‚úì –ü–æ–ª—É—á–µ–Ω–æ [2]: Hello Kafka 2
  Partition: 0, Offset: 1, Timestamp: 1737049201000
...
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Producer –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º

–ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏ producer –ø–µ—Ä–≤—ã–º, –∞ consumer –ø–æ—Ç–æ–º:

1. Consumer –º–æ–∂–µ—Ç –Ω–µ —É–≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ —É–∂–µ –±—ã–ª–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω—ã —Ä–∞–Ω–µ–µ (offset —Å–æ—Ö—Ä–∞–Ω—ë–Ω)
2. **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π `group_id` –∏–ª–∏ —Å–±—Ä–æ—Å—å—Ç–µ offset —á–µ—Ä–µ–∑ Kafka UI

### –°–±—Ä–æ—Å offset —á–µ—Ä–µ–∑ Kafka UI

–ï—Å–ª–∏ consumer –Ω–µ –≤–∏–¥–∏—Ç —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Kafka UI: http://localhost:8080
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"Consumers"**
3. –ù–∞–π–¥–∏—Ç–µ consumer group `hello-group`
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Offsets"**
5. –ù–∞–∂–º–∏—Ç–µ **"Reset Offset"** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ **"Earliest"**
6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ consumer —Å–Ω–æ–≤–∞

---

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –í Kafka UI –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ç–æ–ø–∏–∫–µ

**–°–∏–º–ø—Ç–æ–º—ã:**

- –¢–æ–ø–∏–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –ø—É—Å—Ç
- Producer –∑–∞–ø—É—Å–∫–∞–ª—Å—è, –Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø–æ—è–≤–∏–ª–∏—Å—å

**–†–µ—à–µ–Ω–∏–µ:**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ producer –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ–Ω–∏—è:**

   ```bash
   python producer.py
   ```

   –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

   ```
   Producer –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ Kafka
   –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...
   ‚úì –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: Hello Kafka 1 (partition: 0, offset: 0)
   ...
   ```

2. **–ï—Å–ª–∏ –±—ã–ª–∏ –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**

   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Kafka –∑–∞–ø—É—â–µ–Ω: `docker-compose ps`
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 9092 –¥–æ—Å—Ç—É–ø–µ–Ω
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker logs kafka`

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É:**

   ```bash
   docker exec kafka /opt/kafka/bin/kafka-console-consumer.sh \
     --bootstrap-server localhost:9092 \
     --topic hello-kafka \
     --from-beginning \
     --max-messages 10
   ```

4. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞–Ω–æ–≤–æ:**
   ```bash
   python producer.py
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: Consumer Group –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ Kafka UI

**–°–∏–º–ø—Ç–æ–º—ã:**

- –í —Ä–∞–∑–¥–µ–ª–µ "Consumers" –Ω–µ—Ç consumer group `hello-group`
- Consumer –∑–∞–ø—É—Å–∫–∞–ª—Å—è, –Ω–æ –≥—Ä—É–ø–ø–∞ –Ω–µ –≤–∏–¥–Ω–∞

**–ü—Ä–∏—á–∏–Ω–∞:**
Consumer group –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ Kafka UI **—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ consumer –ø—Ä–æ—á–∏—Ç–∞–ª —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ**. –ï—Å–ª–∏ —Ç–æ–ø–∏–∫ –ø—É—Å—Ç –∏–ª–∏ consumer –Ω–µ —É—Å–ø–µ–ª –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è, –≥—Ä—É–ø–ø–∞ –Ω–µ –ø–æ—è–≤–∏—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:**

1. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ç–æ–ø–∏–∫–µ –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è:**

   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ producer: `python producer.py`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Kafka UI, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—è–≤–∏–ª–∏—Å—å

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ consumer –∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å —á—Ç–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π:**

   ```bash
   python consumer.py
   ```

   Consumer –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –≤—ã–≤–µ—Å—Ç–∏ –∏—Ö.

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ consumer groups —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É:**

   ```bash
   docker exec kafka /opt/kafka/bin/kafka-consumer-groups.sh \
     --bootstrap-server localhost:9092 \
     --list
   ```

   –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –≥—Ä—É–ø–ø–∞ `hello-group`.

4. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É Kafka UI (F5)** ‚Äî –≥—Ä—É–ø–ø–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ "Consumers".

### –ü—Ä–æ–±–ª–µ–º–∞: Producer –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

**–°–∏–º–ø—Ç–æ–º—ã:**

- Producer –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ —Ç–æ–ø–∏–∫–µ
- –ù–µ—Ç –æ—à–∏–±–æ–∫, –Ω–æ –∏ –Ω–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–∫–∏

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:**

   ```bash
   python test_connection.py
   ```

   –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫—É/–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π.

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É–ª—É—á—à–µ–Ω–Ω—ã–π producer:**

   ```bash
   python producer.py
   ```

   –û–Ω –ø–æ–∫–∞–∂–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ.

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Kafka:**

   ```bash
   # Windows PowerShell
   Test-NetConnection -ComputerName localhost -Port 9092

   # –ò–ª–∏ —á–µ—Ä–µ–∑ telnet
   telnet localhost 9092
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Kafka –Ω–∞ –æ—à–∏–±–∫–∏:**

   ```bash
   docker logs kafka --tail 50 | Select-String -Pattern "ERROR|Exception|Failed"
   ```

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–ø–∏–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:**
   ```bash
   docker exec kafka /opt/kafka/bin/kafka-topics.sh --list --bootstrap-server localhost:9092
   ```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

- Kafka –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –ü–æ—Ä—Ç 9092 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω —Ñ–∞–π—Ä–≤–æ–ª–æ–º
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å bootstrap_servers
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é Docker

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤ Kafka UI

1. ‚úÖ **–°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–ø–∏–∫** (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å–æ–∑–¥–∞–Ω)
2. ‚úÖ **–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ producer:**
   ```bash
   python producer.py
   ```
   –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å offset'–∞–º–∏.
3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Kafka UI**, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—è–≤–∏–ª–∏—Å—å:
   - Topics ‚Üí hello-kafka ‚Üí Messages
   - Seek Type: Earliest
   - Load messages
4. ‚úÖ **–ó–∞–ø—É—Å—Ç–∏—Ç–µ consumer:**
   ```bash
   python consumer.py
   ```
5. ‚úÖ **Consumer –ø—Ä–æ—á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è** ‚Äî consumer group –ø–æ—è–≤–∏—Ç—Å—è –≤ Kafka UI
6. ‚úÖ **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É Kafka UI (F5)** ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª "Consumers"

---

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

Consumer –≤—ã–≤–æ–¥–∏—Ç:

```
–ü–æ–ª—É—á–µ–Ω–æ: Hello Kafka 1
–ü–æ–ª—É—á–µ–Ω–æ: Hello Kafka 2
–ü–æ–ª—É—á–µ–Ω–æ: Hello Kafka 3
–ü–æ–ª—É—á–µ–Ω–æ: Hello Kafka 4
–ü–æ–ª—É—á–µ–Ω–æ: Hello Kafka 5
```

---

## üìå –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

1. –ß—Ç–æ —Ç–∞–∫–æ–µ **KRaft** –∏ —á–µ–º –æ–Ω –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç ZooKeeper?
2. –ö–∞–∫–∏–µ —Ä–æ–ª–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç Kafka-–±—Ä–æ–∫–µ—Ä –≤ –≤–µ—Ä—Å–∏–∏ 4.1.1?
3. –ß—Ç–æ —Ç–∞–∫–æ–µ **offset**?
4. –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `group_id`?
5. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç, –µ—Å–ª–∏ consumer –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ?

---

## üìù –û—Ç—á—ë—Ç –ø–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ

–û—Ç—á—ë—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

1. –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã
2. –í–µ—Ä—Å–∏—é Kafka (**4.1.1, KRaft**)
3. Docker Compose —Ñ–∞–π–ª
4. –ö–æ–¥ producer –∏ consumer
5. –°–∫—Ä–∏–Ω—à–æ—Ç—ã —Ä–∞–±–æ—Ç—ã
6. –û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
7. –í—ã–≤–æ–¥—ã

---

## ‚≠ê –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)

- –ò–∑–º–µ–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ JSON
- –î–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á —Å–æ–æ–±—â–µ–Ω–∏—è (`key`)
- –ó–∞–ø—É—Å—Ç–∏—Ç—å **–¥–≤–∞ consumer –≤ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ**
- –ò–∑–º–µ–Ω–∏—Ç—å `auto_offset_reset` –Ω–∞ `latest` –∏ –æ–±—ä—è—Å–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

## üéì –í—ã–≤–æ–¥

–í —Ö–æ–¥–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª –∏–∑—É—á–µ–Ω –ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã Apache Kafka 4.1.1 –≤ —Ä–µ–∂–∏–º–µ KRaft –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–æ—Å—Ç–æ–π –æ–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É producer –∏ consumer –Ω–∞ —è–∑—ã–∫–µ Python.

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –¥–∞–ª—å—à–µ –º–æ–≥—É:

- —Å–¥–µ–ª–∞—Ç—å **–õ–† ‚Ññ2 (–ª–æ–≥–∏, JSON, –∫–ª—é—á–∏)**
- –æ—Ñ–æ—Ä–º–∏—Ç—å **–º–µ—Ç–æ–¥–∏—á–∫—É –≤ Word**
- –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å **–∑–∞–¥–∞–Ω–∏—è + –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏**
- –ø–æ–∫–∞–∑–∞—Ç—å **Kafka UI (Redpanda Console / AKHQ)**

–°–∫–∞–∂–∏, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–∞–ª—å—à–µ üöÄ
